{%extends "SpljBundle:Bloc:skeleton.html.twig"%}
{% block title %}Liste QCM{% endblock %}
{% block class %}dashboard qcm{% endblock %}
{% block h1 %}liste des qcm{% endblock %}
{% block body %}
{% if user.profil == 1 %}
    <a class="btn add" href="{{ url('splj.dashTeacher.create-mcq')}}"><i class="fa fa-plus-square"></i><span>QCM</span></a>
{% endif %}
<table class="table table-striped table-advance table-hover">
    <thead>
        <tr>
            <th><i class="fa fa-paw"></i><span>Sujet</span></th>
            <th class="hidden-phone"><i class="fa fa-university"></i><span>Thème</span></th>
            <th class="centered hidden-phone"><i class="fa fa-question"></i><span>Questions</span></th>
            <th><i class="fa fa-male"></i><span>Auteur</span></th>
            {% if user.profil == 1 %}
                <th><i class=" fa fa-dot-circle-o"></i><span>Statut</span></th>
                {% else %}
                <th></th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for mcq in mcq %}
            {% if mcq.status != 2  %}
            <tr>
                {% if user.profil == 2 %}
                    <td>{{ mcq.title }}</a></td>
                {% elseif user.profil == 1 %}
                    <td><a href="/dashboard-teacher/update-mcq/{{ mcq.id }}">{{ mcq.title }}</a></td>
                {% endif %}
                <td class="hidden-phone">{{ mcq.theme }}</td>
                <td class="centered hidden-phone">{{ mcq.nbQuestions }}</td>
                <td>Jean-Mitch</td>
                {% if user.profil == 1 %}
                <td>
                    <form action="/dashboard-teacher/update-status-mcq/{{ mcq.id }}" method="POST" novalidate>
                            <select name="status">
                            {% if mcq.status == 0 %}
                                <option selected="selected" value="0">non publié</option>
                                <option  value="1">publié</option>
                            {% else %}
                                <option selected="selected" value="1">publié</option>
                                <option  value="0">non publié</option>
                            {% endif %}
                            </select>
                        <button type="submit" class="btn btn-success btn-xs">mettre à jour</button>
                    </form>
                </td>
                <td>
                    <button class="btn btn-primary btn-xs"><a href="/dashboard-teacher/update-mcq/{{ mcq.id }}"><i class="fa fa-pencil"></i></a></button>
                    <button class="btn btn-danger btn-xs"><a href="/dashboard-teacher/delete-mcq/{{ mcq.id }}"><i class="fa fa-trash-o"></i></a></button>
                </td>
                {% else %}
                    {% set qcmRepondu = false %}
                    {% set qcmScore = 0 %}
                    {% set qcmScoreMax = 0 %}
                    {% for score in scores %}
                        {% if score.mcqId == mcq.id %}
                            {% set qcmRepondu = true %}
                            {% set qcmScore = score.score %}
                            {% set qcmScoreMax = score.scoreMax %}
                        {% endif %}
                    {% endfor %}
                    {% if qcmRepondu == false %}
                        <td>
                            <button class="btn btn-success btn-xs"><a href="/dashboard-student/student-answer/{{ user.id }}/{{ mcq.id }}"><i class="fa "></i>répondre</a></button>
                        </td>
                    {% else %}
                        <td>score : {{ qcmScore }}/{{ qcmScoreMax }}</td>
                    {% endif %}
                {% endif %}
            </tr>
            {% endif %}
        {% endfor %}
    </tbody>
</table>
{% endblock %}
